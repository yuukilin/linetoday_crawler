name: news-crawler-schedule

on:
  schedule:
    # GitHub cron 用 UTC！台北 15:30 = UTC 07:30
    - cron: '30 7 * * 1-5'
  workflow_dispatch:  # 手動按按鈕也能觸發（方便除錯）

jobs:
  crawl:
    runs-on: ubuntu-latest

    env:                        # 這些值來自 Secrets
      DEEPSEEK_KEY: ${{ secrets.DEEPSEEK_KEY }}
      MAIL_TO:      ${{ secrets.MAIL_TO }}
      GCP_JSON:     ${{ secrets.GCP_JSON }}  # 如需走 Google API

    steps:
      - uses: actions/checkout@v4   # 取最新程式碼
      - uses: actions/setup-node@v4 # 裝 Node（20 為例）
        with:
          node-version: '20'

      - run: npm ci                 # 安裝 package.json 裡鎖定的依賴
      - run: node src/index.js      # 執行你的主程式
